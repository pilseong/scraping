레드마인은 Jira를 대체할 수 있는 오픈 소스 이슈트레커로 Ruby On Rails로 만들어 졌다. 정부기관의 서버는 인터넷이 되지 않기 때문에 사무실에 있는 유휴 PC를 사용하여 설치하였는데, 현재 파일서버로도 사용 중인 장비라 Windows 기반이라 설치하기 쉽지 않았다. Bitnami로 설치하면 쉽긴 하지만 Native 설치가 되지 않는다. 윈도우로 레드마인 설치에 도움이 될만한 글을 찾아 볼 수 없어 혹시 다른 사람들에게 도움이 될까 남겨 놓는다. 주요문제는 루비 환경 설정인데 리눅스는 쉽게 해결되겠지만, msys2환경이면 컴파일 오류가 많이 발생한다. 대부분 라이브러가 없어서 그렇다. 그래서 필요한 라이브러리를 챙겨야 하고 mysql 경우는 환경에 따라 mysql.h 헤더 파일로 컴파일해 줄 경우도 있다. 1. mysql 설치 - installer가 아닌 zip파일 형식 2. mysql 폴더에 풀기 2-1 mysql/bin 폴더의 mysqld --initialize-insecure --console을 실행 data 폴더를 생성한다. 2-2 -insecure를 사용하지 않으면 추가적인 설정이 필요하기 때문에 귀찮아 진다. 내부시스템이라면 그냥 비보안 3. redmine 다운로드 4.2.3 버전 4. dbeaver 설치 접속확인 5. mysqld --console로 서버기동 6. redmine의 버전에 적합한 ruby 2.7.5버전 devkit+ 로 설치한다. devkit+로 설치하지 않으면 개발용 C 라이브러리가 없어 나중에 빌드 시 에러가 발생한다. pgp가 정상적으로 설치되어 msys2가 제대로 업데이트 되어야 한다. 7. 설치가 종료된 후 msys2를 설치하여 기본 C 개발환경을 구축한다. 7-1 종료 후 자동으로 실행되는 업데이트 스크립트를 사용하여 1~3번를 순차적으로 실행한다. 8. gem install rails -v 5.2 로 rails를 설치한다. - rails 버전은 redmine 버전 참조 9. rails 설치 시 오류가 발생한다. mimemagic-0.3.10 9-1 https://stackoverflow.com/questions/66808927/error-installing-ruby-on-rails-on-windows-10 링크를 참고하여 설치하고 환경설정을 해준다. 9-2 shared-mime-info-2.0을 압축해지 C:\에 복사한다. FREEDESKTOP_MIME_TYPES_PATH 환경변수를 C:\shared-mime-info 2.0\data\freedesktop.org.xml.in로 설정 9-3 gem install mime-types-data 설치 10. dbeaver를 통해 데이터베이스에 유저를 생성한다. 10-1 CREATE DATABASE redmine CHARACTER SET utf8mb4; 10-2 CREATE USER 'redmine'@'localhost' IDENTIFIED BY 'my_password'; 10-3 GRANT ALL PRIVILEGES ON redmine.* TO 'redmine'@'localhost'; 11. 에디터로 데이터베이스 접속관련 내용을 수정해 준다. 11-1 config/database.yml.example --> config/database.yml production: adapter: mysql2 database: redmine host: localhost username: redmine password: "my_password" 12. bundler 설치하기 gem install bundler 13. bundle install --without development test 를 통해 redmine의 라이브러리를 설치한다. 13. mysql2 에러가 발생한다. 14. gem install mysql2 -v 0.2.6 버전을 낮추어서 설치 그래도 에러가 발생한다 14-1 gem install mysql2 --platform=ruby -- '--with-mysql-lib="C:\mysql\lib" --with-mysql-include="C:\mysql\include" --with-mysql-dir="C:\mysql"' 15. 데이터베이스 생성 및 암호화 설정 15-1 bundle exec rake generate_secret_token 15-2 데이터베이스 마이그레이션(테이블 생성) set RAILS_ENV=production bundle exec rake db:migrate 16. 기본데이터를 주입한다. set RAILS_ENV=production set REDMINE_LANG=ko bundle exec rake redmine:load_default_data 17. 테스트 서버 - bundle exec rails server webrick -e production